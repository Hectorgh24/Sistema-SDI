<!DOCTYPE html>
<html>
<head>
    <title>Test API Carpetas</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        input, select, button { padding: 10px; margin: 5px; width: 100%; box-sizing: border-box; }
        button { background: blue; color: white; cursor: pointer; }
        pre { background: #f0f0f0; padding: 10px; overflow: auto; max-height: 300px; }
    </style>
</head>
<body>
<div class="container">
    <h1>Test API Carpetas</h1>
    
    <h2>Crear Carpeta</h2>
    <input type="text" id="titulo" placeholder="Título" value="Test Carpeta">
    <input type="text" id="etiqueta" placeholder="Etiqueta" value="TEST-001">
    <input type="text" id="descripcion" placeholder="Descripción" value="Carpeta de prueba">
    <input type="number" id="no_carpeta" placeholder="No. Carpeta" value="10">
    <button onclick="crearCarpeta()">Crear</button>
    
    <h2>Resultado</h2>
    <pre id="resultado">Esperando resultado...</pre>
</div>

<script>
const baseURL = 'http://localhost/Programa-Gestion-SDI/api';

async function crearCarpeta() {
    const datos = {
        no_carpeta_fisica: parseInt(document.getElementById('no_carpeta').value),
        titulo: document.getElementById('titulo').value,
        etiqueta_identificadora: document.getElementById('etiqueta').value,
        descripcion: document.getElementById('descripcion').value,
        estado_gestion: 'pendiente'
    };

    try {
        console.log('Enviando:', datos);
        const response = await fetch(baseURL + '/carpetas/crear', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify(datos)
        });

        const text = await response.text();
        console.log('Response text:', text);
        const resultado = JSON.parse(text);
        
        document.getElementById('resultado').textContent = JSON.stringify(resultado, null, 2);
    } catch (error) {
        document.getElementById('resultado').textContent = 'Error: ' + error.message;
    }
}

// También listar carpetas
async function listarCarpetas() {
    try {
        const response = await fetch(baseURL + '/carpetas', {
            credentials: 'include'
        });
        const resultado = await response.json();
        console.log('Carpetas:', resultado);
    } catch (error) {
        console.error('Error listando:', error);
    }
}

// Test al cargar
window.addEventListener('load', listarCarpetas);
</script>
</body>
</html>
